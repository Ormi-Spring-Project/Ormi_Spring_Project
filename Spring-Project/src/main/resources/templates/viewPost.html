<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <title>Your App? My App! YAMA - 게시글 보기</title>
    <script th:src="@{/js/comment.js}"></script>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/viewPost.css}">
</head>
<body>
<header>
    <div class="header-container">
        <div class="logo">
            <img src="/images/yama_logo.png" alt="YAMA Logo">
        </div>
        <nav>
            <ul>
                <li th:if="${userDTO != null and userDTO.getAuthority().name() != 'BANNED'}">
                    <a th:if="${userDTO.getAuthority().name() == 'USER'}"
                       th:href="@{/v1/user/{id}(id=${userDTO.getId()})}">My Page</a>
                    <a th:if="${userDTO.getAuthority().name() == 'ADMIN'}" th:href="@{/v1/admin}">Admin</a>
                </li>
                <li><a th:if="${userDTO == null}" th:href="@{/v1/signup}">Sign Up</a></li>
                <li th:if="${userDTO == null}"><a th:href="@{/v1/login}">Log In</a></li>
                <li th:if="${userDTO != null}"><a th:href="@{/v1/logout}" onclick="logoutMessage()">Log Out</a></li>
            </ul>
        </nav>
    </div>
</header>
<main>
    <div class="back-button-container">
        <button th:onclick="|location.href='@{/v1/posts}'|" class="back-button">Go To Back</button>
    </div>
    <section class="post-container">
        <!-- notice 유형 게시글 -->
        <div th:if="${type == 'notice'}">
            <h1 th:text="${board.getTitle()}"></h1>
            <div class="icon">
                <img class="icon-img" src="/images/img-place-holder.png">
                <div th:if="${canEdit}">
                    <button
                            th:onclick="|location.href='@{/v1/posts/notice/{id}/edit(id=${board.id})}'|"
                            class="icon-img-add-button">
                        Edit Button
                    </button>

                    <form th:action="@{/v1/posts/notice/{id}(id=${board.id})}" method="post">
                        <input type="hidden" name="_method" value="delete"/>
                        <button type="submit" class="delete-button" onclick="return confirm('정말로 이 게시글을 삭제하시겠습니까?')">
                            Delete
                        </button>
                    </form>
                </div>
            </div>

            <div class="user-information">
                <div>
                    <div class="user">
                        <img class="nickname-img" src="/images/nickname-icon.png">
                        <div class="nickname" th:text="${board.authorName}">Nickname</div>
                    </div>
                    <div th:text="${#dates.format(board.createdAt, 'yyyy-MM-dd HH:mm:ss')}"></div>
                </div>

                <div class="download" th:if="${board.application != null}">
                    <img class="download-img" src="/images/link.png">
                    <a th:href="${board.application}" th:text="${board.application}">애플리케이션 링크</a>
                </div>
            </div>
            <div class="content" th:utext="${board.content}"></div>
        </div>

        <!-- post 유형 게시글 -->
        <div th:if="${type == 'post'}">
            <h1 th:text="${board.getTitle()}"></h1>
            <div class="icon">
                <img class="icon-img" src="/images/img-place-holder.png">
                <div th:if="${canEdit}">
                    <button
                            th:onclick="|location.href='@{/v1/posts/post/{id}/edit(id=${board.id})}'|"
                            class="icon-img-add-button">
                        Edit Button
                    </button>

                    <form th:action="@{/v1/posts/post/{id}(id=${board.id})}" method="post">
                        <input type="hidden" name="_method" value="delete"/>
                        <button type="submit" class="delete-button" onclick="return confirm('정말로 이 게시글을 삭제하시겠습니까?')">
                            Delete
                        </button>
                    </form>
                </div>
            </div>

            <div class="user-information">
                <div>
                    <div class="user">
                        <img class="nickname-img" src="/images/nickname-icon.png">
                        <div class="nickname" th:text="${board.authorName}">Nickname</div>
                    </div>
                    <div th:text="${#dates.format(board.createdAt, 'yyyy-MM-dd HH:mm:ss')}"></div>
                </div>

                <div class="download" th:if="${board.application != null}">
                    <img class="download-img" src="/images/link.png">
                    <a th:href="${board.application}" th:text="${board.application}">애플리케이션 링크</a>
                </div>
            </div>
            <div class="content" th:utext="${board.content}"></div>
        </div>

        <!-- 댓글 섹션 (두 유형 모두에 적용) -->
        <div class="comment-section">
            <h2>댓글</h2>
            <div id="commentContainer">
                <!-- 댓글들이 여기에 동적으로 추가됩니다 -->
            </div>
            <div class="comment-write">
                <textarea id="commentContent" placeholder="댓글을 입력하세요"></textarea>
                <div class="comment-button-container">
                    <button class="comment-button" onclick="submitComment()">Comment</button>
                </div>
            </div>
        </div>
    </section>
</main>
<footer>
    <div class="footer-container">
        <div class="footer-logo">
            <img src="/images/yama_logo.png" alt="YAMA Logo">
        </div>
        <div class="footer-info">
            <div class="footer-contact">
                <h4>Contact</h4>
                <ul>
                    <li><p>010-XXXX-XXXX</p></li>
                    <li><p>Eh9700@Naver.Com</p></li>
                </ul>
            </div>
            <div class="footer-about">
                <h4>ABOUT</h4>
                <ul>
                    <li><a href="#">About Team</a></li>
                    <li><a href="#">ERD</a></li>
                    <li><a href="#">GitHub</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>

<input type="hidden" id="postId" th:value="${board.id}">
<input type="hidden" id="currentUserId" th:value="${userDTO != null ? userDTO.getId() : ''}">

<script>
    function logoutMessage() {
        alert('로그아웃 되었습니다.');
    }
</script>
</body>
</html>